# Проект. Создание рекомендательной системы. Часть 1
## Описание задачи   
На этот раз вы работаете в Яндекс Музыке, популярном стриминговом сервисе с большим каталогом — более 70 млн треков. Чтобы пользователям было легче ориентироваться в столь обширном музыкальном потоке, вас попросили создать эффективную систему персональных рекомендаций.
### Проблема   
Взаимодействие с музыкальным сервисом должно быть удобным, простым и приятным. Для этого пользователю нужно предлагать треки или подборки, основываясь на его вкусах и предпочтениях. Это делают почти все популярные сервисы, — немногие пользователи захотят тратить время на поиски потенциально интересной музыки, единожды опробовав отточенную систему персональных рекомендаций.   
### Бизнес-задача   
Вам нужно облегчить пользовательский опыт, создав систему персональных рекомендаций.   
Задача машинного обучения   
Чтобы решить задачу, вы будете использовать средства машинного обучения:    
За основу возьмите взаимодействия ~1,4 млн пользователей с 1 млн треков.   
Используя изученные в предыдущих уроках алгоритмы, постройте пайплайн для расчёта персональных рекомендаций.   
Разработайте сервис рекомендаций.   
Результатом работы должен стать набор скриптов в репозитории, выполнение которых позволит рассчитать персональные рекомендации, а затем запустить соответствующий сервис и получить их.   
### Данные   
Данные находятся в трёх файлах.   
Данные о треках — в файле tracks.parquet:   
track_id — идентификатор музыкального трека;   
albums — список идентификаторов альбомов, содержащих трек;   
artists — список идентификаторов исполнителей трека;   
genres — список идентификаторов жанров, к которым принадлежит трек.   
Имена артистов, названия альбомов, треков и жанров — в файле catalog_names.parquet:   
id — идентификатор одной из каталожных единиц (трека, альбома, исполнителя, жанра);   
type — тип идентификатора;   
name — имя (название) каталожной единицы.   
Данные о том, какие пользователи прослушали тот или иной трек, — в файле interactions.parquet :
user_id — идентификатор пользователя,  
track_id — идентификатор музыкального трека,   
track_seq — номер места трека в истории пользователя,   
started_at — дата начала прослушивания трека.   
### Инфраструктура и инструменты   
Для выполнения проекта вам понадобятся те же самые инструменты, которые вы использовали в уроках этого спринта:    
Виртуальное окружение Python   
Jupyter Lab   
Visual Studio Code   
Персональный S3-бакет    
Для проведения всех этапов используйте виртуальную машину.   
Инструкция по выполнению проекта (часть 1)    
Запустите виртуальную машину, когда будете готовы приступить к выполнению проекта.   
Задание для запуска виртуальной машины    
Клонирование репозитория   
Склонируйте репозиторий в свой GitHub и на виртуальную машину.   
### Этап 1. Первичная подготовка данных   
Прочитайте файлы с данными, проведите оценку данных на наличие проблем:   
Нужно ли изменить тип идентификаторов?   
Есть ли треки с неизвестными исполнителями, альбомами, жанрами?   
При необходимости решите найденные проблемы.   
Результат этапа:   
Выполненный код в ноутбуке recommendations.ipynb.   
### Этап 2. Анализ данных и их подготовка    
Проведите EDA данных, чтобы получить представление:   
о распределении количества прослушанных треков,   
о наиболее популярных треках,   
о наиболее популярных жанрах,   
о треках, которые никто не прослушал.   
Сохраните данные в двух файлах в персональном S3-бакете по пути recsys/data/:   
items.parquet — все данные о музыкальных треках,   
events.parquet — все данные о взаимодействиях.   
Результаты этапа:   
Выполненный код в ноутбуке recommendations.ipynb.   
Файлы items.parquet, events.parquet.   
### Этап 3. Офлайн-рекомендации   
Подготовьте данные для обучения:   
Загрузите ранее сохранённые данные из файлов items.parquet, events.parquet.   
Разбейте данные на тренировочную и тестовую выборки: в тренировочную отнесите все данные до 16 декабря 2022 года (не включительно).    
Рассчитайте рекомендации нескольких типов, сохраните каждый тип в своём файле, в персональном S3-бакете по пути recsys/recommendations/:   
топ популярных — в top_popular.parquet;   
персональные (при помощи ALS) — в personal_als.parquet;  
похожие треки, или i2i (при помощи ALS) — в similar.parquet.   
Постройте ранжирующую модель, которая использует минимум три признака. Отранжируйте рекомендации, а итоговые сохраните в recommendations.parquet.   
Проверьте оценку качества трёх типов рекомендаций:    
топ популярных;   
персональных, полученных при помощи ALS;   
итоговых (по метрикам: recall, precision, coverage, novelty).   
Приведите значения метрик в ноутбуке.   
Результаты этапа:  
Выполненный код в ноутбуке recommendations.ipynb.   
Файлы с рекомендациями:   
top_popular.parquet,   
similar.parquet,   
personal_als.parquet,   
recommendations.parquet.  
Загрузка Jupyter Notebook   
В этом уроке вам потребуется загрузить файл с ноутбуком recommendations.ipynb, чтобы его проверили ревьюеры. Код в ноутбуке должен быть выполнен и содержать вывод.   
Важно! Выполняйте задание на своей виртуальной машине. В этом уроке вы только загрузите готовое решение.   
Чтобы вы могли сдать блокнот и потом прочитать комментарии ревьюера, в разделе «Cookie-файлы» в настройках вашего браузера установите переключатель в положение «Разрешены».  

### Как будут проверять проект   
Ваш проект будут оценивать по конкретным критериям. Прежде чем решать задачу, внимательно изучите их. Задание считается выполненным, если:   
Этап 1. Вы оценили типы идентификаторов и преобразовали их при необходимости. Проверили наличие треков с неизвестными исполнителями, альбомами, жанрами и при необходимости исправили данные.   
Этап 2. Вы провели анализ данных (EDA) и оформили результаты в ноутбуке. Показаны распределения количества прослушанных треков, популярные треки и жанры, а также треки, которые никто не прослушал. Данные сохранены в файлах items.parquet и events.parquet. 
Этап 3. Вы успешно загрузили данные и разделили их на тренировочную и тестовую выборки. Рассчитали рекомендации разных типов и сохранили их в соответствующие файлы. Построили ранжирующую модель с использованием минимум трёх признаков и сохранили её в recommendations.parquet. Провели оценку качества рекомендаций по заданным метрикам и описали результаты в ноутбуке.   